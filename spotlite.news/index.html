<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Spotlite News - Your trusted source for breaking news, technology updates, and financial insights">
    <meta name="keywords" content="news, breaking news, technology, finance, privacy, gaming">
    <meta name="author" content="Spotlite News">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Spotlite News - Breaking News & Insights">
    <meta property="og:description" content="Stay informed with the latest news across technology, finance, and more">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://spotlite.news">
    <meta property="og:image" content="https://spotlite.news/images/og-image.jpg">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Spotlite News - Breaking News & Insights">
    <meta name="twitter:description" content="Stay informed with the latest news across technology, finance, and more">
    <meta name="twitter:image" content="https://spotlite.news/images/twitter-image.jpg">
    
    <title>Spotlite News - Breaking News & Insights</title>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles/main.css">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
</head>
<body>
    <!-- Site Header -->
    <header class="site-header" role="banner">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <h1><a href="/" aria-label="Spotlite News Home">Spotlite News</a></h1>
                    <p class="tagline">Breaking News & Insights</p>
                </div>
                <nav class="main-nav" role="navigation" aria-label="Main navigation">
                    <ul>
                        <li><a href="#" aria-label="Home">Home</a></li>
                        <li><a href="#" aria-label="Technology News">Technology</a></li>
                        <li><a href="#" aria-label="Finance News">Finance</a></li>
                        <li><a href="#" aria-label="Privacy News">Privacy</a></li>
                        <li><a href="#" aria-label="Gaming News">Gaming</a></li>
                        <li><a href="#" aria-label="About Us">About</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content" role="main">
        <div class="container">
            <div class="content-grid">
                <!-- Primary Content Area -->
                <section class="primary-content">
                    <article class="featured-story" id="article-1" data-article-id="1" data-article-tag="privacy">
                        <header class="article-header">
                            <h2>Breaking: New Privacy Regulations Reshape Digital Advertising</h2>
                            <div class="article-meta">
                                <time datetime="2024-01-15">January 15, 2024</time>
                                <span class="author">By Sarah Chen</span>
                                <span class="category">Privacy</span>
                            </div>
                        </header>
                        <div class="article-content">
                            <p>New privacy regulations are transforming how companies approach digital advertising, with innovative solutions emerging that protect user data while maintaining targeting effectiveness...</p>
                            <p>Industry experts are calling this shift a "privacy revolution" that puts users back in control of their data while still enabling relevant advertising experiences.</p>
                        </div>
                    </article>

                    <div class="news-grid">
                        <article class="news-item" id="article-2" data-article-id="2" data-article-tag="technology">
                            <header class="article-header">
                                <h3>Tech Giants Announce New Blockchain Initiative</h3>
                                <div class="article-meta">
                                    <time datetime="2024-01-14">January 14, 2024</time>
                                    <span class="category">Technology</span>
                                </div>
                            </header>
                            <div class="article-content">
                                <p>Major technology companies are collaborating on a new blockchain-based initiative designed to enhance data security and user privacy...</p>
                            </div>
                        </article>

                        <article class="news-item" id="article-3" data-article-id="3" data-article-tag="finance">
                            <header class="article-header">
                                <h3>Financial Markets See Surge in Privacy-Focused Investments <span class="finance-badge">💰 Finance</span></h3>
                                <div class="article-meta">
                                    <time datetime="2024-01-14">January 14, 2024</time>
                                    <span class="category">Finance</span>
                                </div>
                            </header>
                            <div class="article-content">
                                <p>Investment firms are increasingly focusing on privacy-preserving technologies, with venture capital flowing into innovative startups...</p>
                            </div>
                        </article>

                        <article class="news-item" id="article-4" data-article-id="4" data-article-tag="gaming">
                            <header class="article-header">
                                <h3>Gaming Industry Embraces Zero-Knowledge Proof Technology</h3>
                                <div class="article-meta">
                                    <time datetime="2024-01-13">January 13, 2024</time>
                                    <span class="category">Gaming</span>
                                </div>
                            </header>
                            <div class="article-content">
                                <p>Leading gaming companies are implementing zero-knowledge proof systems to enhance player privacy while maintaining fair gameplay...</p>
                            </div>
                        </article>
                    </div>
                </section>

                <!-- Sidebar -->
                <aside class="sidebar" role="complementary">
                    <section class="trending-section">
                        <h3>Trending Topics</h3>
                        <ul class="trending-list">
                            <li><a href="#" data-article-id="5" data-article-tag="privacy" aria-label="Read about Privacy Technology">Privacy Technology</a></li>
                            <li><a href="#" data-article-id="6" data-article-tag="technology" aria-label="Read about Blockchain Innovation">Blockchain Innovation</a></li>
                            <li><a href="#" data-article-id="7" data-article-tag="privacy" aria-label="Read about Digital Security">Digital Security</a></li>
                            <li><a href="#" data-article-id="8" data-article-tag="finance" aria-label="Read about DeFi Updates">DeFi Updates <span class="finance-badge">💰 Finance</span></a></li>
                            <li><a href="#" data-article-id="9" data-article-tag="gaming" aria-label="Read about Gaming Tech">Gaming Tech</a></li>
                        </ul>
                    </section>

                    <section class="newsletter-signup">
                        <h3>Stay Updated</h3>
                        <p>Get the latest news delivered to your inbox</p>
                        <form class="newsletter-form">
                            <input type="email" placeholder="Enter your email" aria-label="Email address">
                            <button type="submit">Subscribe</button>
                        </form>
                    </section>
                </aside>
            </div>
        </div>
    </main>

    <!-- ZK Proof modal will be dynamically created when needed -->

    <!-- Footer -->
    <footer class="site-footer" role="contentinfo">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>Spotlite News</h4>
                    <p>Your trusted source for breaking news and insights across technology, finance, and privacy.</p>
                </div>
                <div class="footer-section">
                    <h4>Categories</h4>
                    <ul>
                        <li><a href="#" aria-label="Technology news">Technology</a></li>
                        <li><a href="#" aria-label="Finance news">Finance</a></li>
                        <li><a href="#" aria-label="Privacy news">Privacy</a></li>
                        <li><a href="#" aria-label="Gaming news">Gaming</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>About</h4>
                    <ul>
                        <li><a href="#" aria-label="About us">About Us</a></li>
                        <li><a href="#" aria-label="Contact us">Contact</a></li>
                        <li><a href="#" aria-label="Privacy policy">Privacy Policy</a></li>
                        <li><a href="#" aria-label="Terms of service">Terms of Service</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Spotlite News. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="../lib/ethers/dist/ethers.umd.min.js"></script>
    <script src="../lib/idb/idb.umd.js"></script>
    <script src="../shared/cryptography-browser.js"></script>
    <script src="../shared/database-browser.js"></script>
    <script src="../shared/publisher-keys-browser.js"></script>
    <script src="../shared/zkProofBuilder.js"></script>
    <script src="../shared/privy.js"></script>
    <script src="../shared/profile-store.js"></script>
    <script src="../shared/zkAffinityAgent.js"></script>
    
    <!-- Main Application Script -->
    <script>
        // Finance keywords for article classification
        const FINANCE_KEYWORDS = [
            'finance', 'financial', 'investment', 'investing', 'stocks', 'market', 'markets',
            'banking', 'bank', 'credit', 'loan', 'loans', 'mortgage', 'insurance', 'savings',
            'portfolio', 'trading', 'cryptocurrency', 'crypto', 'bitcoin', 'ethereum', 'defi',
            'yield', 'dividend', 'bonds', 'securities', 'economy', 'economic', 'budget',
            'retirement', 'pension', 'tax', 'taxes', 'wealth', 'money', 'income'
        ];

        // Generate unique session ID
        function generateSessionId() {
            return 'spotlite-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
        }

        // Get or create session ID
        function getSessionId() {
            let sessionId = sessionStorage.getItem('spotlite_session_id');
            if (!sessionId) {
                sessionId = generateSessionId();
                sessionStorage.setItem('spotlite_session_id', sessionId);
            }
            return sessionId;
        }

        // Create attestation for article click
        function createArticleAttestation(articleId, articleTag, articleTitle, isFinanceContent) {
            const attestation = {
                timestamp: Date.now(),
                date: new Date().toISOString(),
                articleId: articleId,
                articleTag: articleTag,
                articleTitle: articleTitle ? articleTitle.substring(0, 100) : 'Unknown',
                isFinanceContent: isFinanceContent,
                userAgent: navigator.userAgent.substring(0, 50),
                sessionId: getSessionId(),
                site: 'spotlite.news',
                action: 'article_click'
            };

            return attestation;
        }

        // Store attestation in localStorage
        function storeAttestation(attestation) {
            try {
                const existing = JSON.parse(localStorage.getItem('zookies_attestations') || '[]');
                existing.push(attestation);
                
                // Keep only last 100 attestations
                if (existing.length > 100) {
                    existing.splice(0, existing.length - 100);
                }
                
                localStorage.setItem('zookies_attestations', JSON.stringify(existing));
                console.log('📝 Attestation stored:', attestation);
            } catch (error) {
                console.error('❌ Failed to store attestation:', error);
            }
        }

        // Track finance article clicks
        function trackFinanceArticleClick(articleId, articleTitle) {
            try {
                const financeClicks = JSON.parse(localStorage.getItem('spotlite_finance_clicks') || '[]');
                const clickData = {
                    timestamp: Date.now(),
                    date: new Date().toISOString(),
                    articleId: articleId,
                    articleTitle: articleTitle,
                    sessionId: getSessionId(),
                    site: 'spotlite.news'
                };
                
                financeClicks.push(clickData);
                localStorage.setItem('spotlite_finance_clicks', JSON.stringify(financeClicks));
                
                console.log('💰 Finance article clicked:', clickData);
                console.log(`📊 Total finance clicks: ${financeClicks.length}`);
                
                // Check if user qualifies for ads (2+ finance clicks)
                if (financeClicks.length >= 2) {
                    console.log('🎯 User qualifies for targeted ads!');
                    
                    // Emit custom event for ZooKies integration
                    window.dispatchEvent(new CustomEvent('user-qualified-for-ads', {
                        detail: {
                            totalFinanceClicks: financeClicks.length,
                            qualificationThreshold: 2,
                            latestClick: clickData,
                            site: 'spotlite.news'
                        }
                    }));
                }
                
                // Emit finance article click event
                window.dispatchEvent(new CustomEvent('finance-article-click', {
                    detail: clickData
                }));
                
            } catch (error) {
                console.error('❌ Failed to track finance click:', error);
            }
        }

        // Handle article click
        function handleArticleClick(event) {
            const target = event.target.closest('[data-article-id]');
            if (!target) return;
            
            const articleId = target.getAttribute('data-article-id');
            const articleTag = target.getAttribute('data-article-tag');
            const articleTitle = target.textContent;
            const isFinanceContent = articleTag === 'finance';
            
            console.log('📰 Article clicked:', {
                id: articleId,
                tag: articleTag,
                title: articleTitle,
                isFinance: isFinanceContent
            });
            
            // Create and store attestation
            const attestation = createArticleAttestation(articleId, articleTag, articleTitle, isFinanceContent);
            storeAttestation(attestation);
            
            // Special handling for finance articles
            if (isFinanceContent) {
                handleFinanceArticleClick(articleId, articleTitle);
            }
        }

        // Handle finance article click
        function handleFinanceArticleClick(articleId, articleTitle) {
            console.log('💰 Finance article clicked:', articleId, articleTitle);
            trackFinanceArticleClick(articleId, articleTitle);
        }

        // Main application initialization
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🎯 Spotlite News loading...');
            console.log('📊 ZooKies Demo - Finance Article Tracking Mode');
            
            // Add click event listeners to all articles
            const articles = document.querySelectorAll('[data-article-id]');
            articles.forEach(article => {
                article.addEventListener('click', handleArticleClick);
                article.style.cursor = 'pointer';
            });
            
            console.log(`📝 Added click tracking to ${articles.length} articles`);
            
            // Initialize demo mode if enabled
            if (localStorage.getItem('spotlite_demo_mode') === 'true') {
                toggleDemoMode();
            }
            
            console.log('✅ Spotlite News ready!');
        });
        
        // ZooKies Demo Integration Hooks
        window.getAttestations = function() {
            const attestations = JSON.parse(localStorage.getItem('zookies_attestations') || '[]');
            const financeClicks = JSON.parse(localStorage.getItem('spotlite_finance_clicks') || '[]');
            
            return {
                attestations,
                financeClicks,
                totalAttestations: attestations.length,
                totalFinanceClicks: financeClicks.length,
                qualifiesForAds: financeClicks.length >= 2,
                site: 'spotlite.news'
            };
        };

        window.getFinanceArticles = function() {
            const financeArticles = [];
            const articles = document.querySelectorAll('[data-article-tag="finance"]');
            
            articles.forEach(article => {
                financeArticles.push({
                    id: article.getAttribute('data-article-id'),
                    title: article.textContent.trim(),
                    tag: article.getAttribute('data-article-tag'),
                    element: article
                });
            });
            
            return financeArticles;
        };

        window.toggleDemoMode = function() {
            const isDemoMode = localStorage.getItem('spotlite_demo_mode') === 'true';
            const newMode = !isDemoMode;
            
            localStorage.setItem('spotlite_demo_mode', newMode.toString());
            
            const financeArticles = document.querySelectorAll('[data-article-tag="finance"]');
            financeArticles.forEach(article => {
                if (newMode) {
                    article.style.backgroundColor = '#fff3cd';
                    article.style.border = '2px solid #ffc107';
                    article.style.borderRadius = '8px';
                    article.style.padding = '10px';
                    article.style.margin = '5px 0';
                } else {
                    article.style.backgroundColor = '';
                    article.style.border = '';
                    article.style.borderRadius = '';
                    article.style.padding = '';
                    article.style.margin = '';
                }
            });
            
            console.log('🎬 Demo mode:', newMode ? 'enabled' : 'disabled');
        };

        window.simulateFinanceClick = function() {
            const financeArticles = document.querySelectorAll('[data-article-tag="finance"]');
            if (financeArticles.length > 0) {
                const randomArticle = financeArticles[Math.floor(Math.random() * financeArticles.length)];
                randomArticle.click();
                console.log('🎯 Simulated finance article click');
            }
        };

        window.checkAdQualification = function() {
            const financeClicks = JSON.parse(localStorage.getItem('spotlite_finance_clicks') || '[]');
            const qualified = financeClicks.length >= 2;
            
            console.log('📊 Ad Qualification Check:', {
                financeClicks: financeClicks.length,
                threshold: 2,
                qualified: qualified
            });
            
            return qualified;
        };

        window.resetDemoState = function() {
            localStorage.removeItem('zookies_attestations');
            localStorage.removeItem('spotlite_finance_clicks');
            localStorage.removeItem('spotlite_demo_mode');
            sessionStorage.removeItem('spotlite_session_id');
            
            console.log('🔄 Demo state reset');
            location.reload();
        };

        window.getDemoStats = function() {
            const attestations = JSON.parse(localStorage.getItem('zookies_attestations') || '[]');
            const financeClicks = JSON.parse(localStorage.getItem('spotlite_finance_clicks') || '[]');
            
            const stats = {
                site: 'spotlite.news',
                totalAttestations: attestations.length,
                financeClicks: financeClicks.length,
                qualifiesForAds: financeClicks.length >= 2,
                threshold: 2,
                financeArticles: window.getFinanceArticles().length,
                sessionId: getSessionId(),
                demoMode: localStorage.getItem('spotlite_demo_mode') === 'true'
            };
            
            console.log('📊 Demo Stats:', stats);
            return stats;
        };
    </script>
</body>
</html> 